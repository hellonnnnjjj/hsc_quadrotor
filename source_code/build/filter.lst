ARM GAS  /tmp/ccRw3Duq.s 			page 1


   1              		.cpu cortex-m4
   2              		.eabi_attribute 27, 1
   3              		.eabi_attribute 28, 1
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 1
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.file	"filter.c"
  14              		.text
  15              	.Ltext0:
  16              		.cfi_sections	.debug_frame
  17              		.section	.text.sin_approx,"ax",%progbits
  18              		.align	1
  19              		.global	sin_approx
  20              		.arch armv7e-m
  21              		.syntax unified
  22              		.thumb
  23              		.thumb_func
  24              		.fpu fpv4-sp-d16
  26              	sin_approx:
  27              	.LVL0:
  28              	.LFB123:
  29              		.file 1 "./app/filter/filter.c"
   1:./app/filter/filter.c **** #include "filter.h"
   2:./app/filter/filter.c **** #include "math.h"
   3:./app/filter/filter.c **** 
   4:./app/filter/filter.c **** 
   5:./app/filter/filter.c **** /****************************************************************************************
   6:./app/filter/filter.c **** 本文件代码参考自betaFlight
   7:./app/filter/filter.c **** github网址 https://github.com/betaflight/betaflight
   8:./app/filter/filter.c **** ****************************************************************************************/
   9:./app/filter/filter.c **** 
  10:./app/filter/filter.c **** 
  11:./app/filter/filter.c **** #define BIQUAD_Q 1.0f / sqrtf(2.0f)     /* quality factor - butterworth*/
  12:./app/filter/filter.c **** #define M_PIf       3.1415926f
  13:./app/filter/filter.c **** 
  14:./app/filter/filter.c **** #define sinPolyCoef3 -1.666665710e-1f        // Double: -1.666665709650470145824129400050267289858e
  15:./app/filter/filter.c **** #define sinPolyCoef5  8.333017292e-3f        // Double:  8.333017291562218127986291618761571373087e
  16:./app/filter/filter.c **** #define sinPolyCoef7 -1.980661520e-4f        // Double: -1.980661520135080504411629636078917643846e
  17:./app/filter/filter.c **** #define sinPolyCoef9  2.600054768e-6f        // Double:  2.600054767890361277123254766503271638682e
  18:./app/filter/filter.c **** 
  19:./app/filter/filter.c **** 
  20:./app/filter/filter.c **** float sin_approx(float x)
  21:./app/filter/filter.c **** {
  30              		.loc 1 21 1 view -0
  31              		.cfi_startproc
  32              		@ args = 0, pretend = 0, frame = 0
  33              		@ frame_needed = 0, uses_anonymous_args = 0
  34              		@ link register save eliminated.
  22:./app/filter/filter.c ****     int32_t xint = x;
  35              		.loc 1 22 5 view .LVU1
  36              		.loc 1 22 13 is_stmt 0 view .LVU2
ARM GAS  /tmp/ccRw3Duq.s 			page 2


  37 0000 FDEEC07A 		vcvt.s32.f32	s15, s0
  38 0004 17EE903A 		vmov	r3, s15	@ int
  39              	.LVL1:
  23:./app/filter/filter.c ****     if (xint < -32 || xint > 32) return 0.0f;                               // Stop here on error i
  40              		.loc 1 23 5 is_stmt 1 view .LVU3
  41              		.loc 1 23 20 is_stmt 0 view .LVU4
  42 0008 2033     		adds	r3, r3, #32
  43              	.LVL2:
  44              		.loc 1 23 8 view .LVU5
  45 000a 402B     		cmp	r3, #64
  46 000c 06D9     		bls	.L3
  47              		.loc 1 23 41 view .LVU6
  48 000e 9FED290A 		vldr.32	s0, .L15
  49              	.LVL3:
  24:./app/filter/filter.c ****     while (x >  M_PIf) x -= (2.0f * M_PIf);                                 // always wrap input an
  25:./app/filter/filter.c ****     while (x < -M_PIf) x += (2.0f * M_PIf);
  26:./app/filter/filter.c ****     if (x >  (0.5f * M_PIf)) x =  (0.5f * M_PIf) - (x - (0.5f * M_PIf));   // We just pick -90..+90
  27:./app/filter/filter.c ****     else if (x < -(0.5f * M_PIf)) x = -(0.5f * M_PIf) - ((0.5f * M_PIf) + x);
  28:./app/filter/filter.c ****     float x2 = x * x;
  29:./app/filter/filter.c ****     return x + x * x2 * (sinPolyCoef3 + x2 * (sinPolyCoef5 + x2 * (sinPolyCoef7 + x2 * sinPolyCoef9
  30:./app/filter/filter.c **** }
  50              		.loc 1 30 1 view .LVU7
  51 0012 7047     		bx	lr
  52              	.LVL4:
  53              	.L4:
  24:./app/filter/filter.c ****     while (x >  M_PIf) x -= (2.0f * M_PIf);                                 // always wrap input an
  54              		.loc 1 24 24 is_stmt 1 discriminator 2 view .LVU8
  24:./app/filter/filter.c ****     while (x >  M_PIf) x -= (2.0f * M_PIf);                                 // always wrap input an
  55              		.loc 1 24 26 is_stmt 0 discriminator 2 view .LVU9
  56 0014 DFED287A 		vldr.32	s15, .L15+4
  57 0018 30EE670A 		vsub.f32	s0, s0, s15
  58              	.LVL5:
  59              	.L3:
  24:./app/filter/filter.c ****     while (x >  M_PIf) x -= (2.0f * M_PIf);                                 // always wrap input an
  60              		.loc 1 24 11 is_stmt 1 discriminator 1 view .LVU10
  61 001c DFED277A 		vldr.32	s15, .L15+8
  62 0020 B4EEE70A 		vcmpe.f32	s0, s15
  63 0024 F1EE10FA 		vmrs	APSR_nzcv, FPSCR
  64 0028 F4DC     		bgt	.L4
  24:./app/filter/filter.c ****     while (x >  M_PIf) x -= (2.0f * M_PIf);                                 // always wrap input an
  65              		.loc 1 24 11 is_stmt 0 discriminator 1 view .LVU11
  66 002a 03E0     		b	.L5
  67              	.L6:
  25:./app/filter/filter.c ****     if (x >  (0.5f * M_PIf)) x =  (0.5f * M_PIf) - (x - (0.5f * M_PIf));   // We just pick -90..+90
  68              		.loc 1 25 24 is_stmt 1 discriminator 2 view .LVU12
  25:./app/filter/filter.c ****     if (x >  (0.5f * M_PIf)) x =  (0.5f * M_PIf) - (x - (0.5f * M_PIf));   // We just pick -90..+90
  69              		.loc 1 25 26 is_stmt 0 discriminator 2 view .LVU13
  70 002c DFED227A 		vldr.32	s15, .L15+4
  71 0030 30EE270A 		vadd.f32	s0, s0, s15
  72              	.LVL6:
  73              	.L5:
  25:./app/filter/filter.c ****     if (x >  (0.5f * M_PIf)) x =  (0.5f * M_PIf) - (x - (0.5f * M_PIf));   // We just pick -90..+90
  74              		.loc 1 25 11 is_stmt 1 discriminator 1 view .LVU14
  75 0034 DFED227A 		vldr.32	s15, .L15+12
  76 0038 B4EEE70A 		vcmpe.f32	s0, s15
  77 003c F1EE10FA 		vmrs	APSR_nzcv, FPSCR
  78 0040 F4D4     		bmi	.L6
ARM GAS  /tmp/ccRw3Duq.s 			page 3


  26:./app/filter/filter.c ****     else if (x < -(0.5f * M_PIf)) x = -(0.5f * M_PIf) - ((0.5f * M_PIf) + x);
  79              		.loc 1 26 5 view .LVU15
  26:./app/filter/filter.c ****     else if (x < -(0.5f * M_PIf)) x = -(0.5f * M_PIf) - ((0.5f * M_PIf) + x);
  80              		.loc 1 26 8 is_stmt 0 view .LVU16
  81 0042 DFED207A 		vldr.32	s15, .L15+16
  82 0046 B4EEE70A 		vcmpe.f32	s0, s15
  83 004a F1EE10FA 		vmrs	APSR_nzcv, FPSCR
  84 004e 20DD     		ble	.L14
  26:./app/filter/filter.c ****     else if (x < -(0.5f * M_PIf)) x = -(0.5f * M_PIf) - ((0.5f * M_PIf) + x);
  85              		.loc 1 26 30 is_stmt 1 discriminator 1 view .LVU17
  26:./app/filter/filter.c ****     else if (x < -(0.5f * M_PIf)) x = -(0.5f * M_PIf) - ((0.5f * M_PIf) + x);
  86              		.loc 1 26 55 is_stmt 0 discriminator 1 view .LVU18
  87 0050 30EE670A 		vsub.f32	s0, s0, s15
  88              	.LVL7:
  26:./app/filter/filter.c ****     else if (x < -(0.5f * M_PIf)) x = -(0.5f * M_PIf) - ((0.5f * M_PIf) + x);
  89              		.loc 1 26 32 discriminator 1 view .LVU19
  90 0054 37EEC00A 		vsub.f32	s0, s15, s0
  91              	.LVL8:
  92              	.L9:
  28:./app/filter/filter.c ****     return x + x * x2 * (sinPolyCoef3 + x2 * (sinPolyCoef5 + x2 * (sinPolyCoef7 + x2 * sinPolyCoef9
  93              		.loc 1 28 5 is_stmt 1 view .LVU20
  28:./app/filter/filter.c ****     return x + x * x2 * (sinPolyCoef3 + x2 * (sinPolyCoef5 + x2 * (sinPolyCoef7 + x2 * sinPolyCoef9
  94              		.loc 1 28 11 is_stmt 0 view .LVU21
  95 0058 60EE006A 		vmul.f32	s13, s0, s0
  96              	.LVL9:
  29:./app/filter/filter.c **** }
  97              		.loc 1 29 5 is_stmt 1 view .LVU22
  29:./app/filter/filter.c **** }
  98              		.loc 1 29 18 is_stmt 0 view .LVU23
  99 005c 20EE267A 		vmul.f32	s14, s0, s13
  29:./app/filter/filter.c **** }
 100              		.loc 1 29 86 view .LVU24
 101 0060 DFED197A 		vldr.32	s15, .L15+20
 102 0064 66EEA77A 		vmul.f32	s15, s13, s15
  29:./app/filter/filter.c **** }
 103              		.loc 1 29 81 view .LVU25
 104 0068 9FED186A 		vldr.32	s12, .L15+24
 105 006c 77EEC67A 		vsub.f32	s15, s15, s12
  29:./app/filter/filter.c **** }
 106              		.loc 1 29 65 view .LVU26
 107 0070 67EEA67A 		vmul.f32	s15, s15, s13
  29:./app/filter/filter.c **** }
 108              		.loc 1 29 60 view .LVU27
 109 0074 9FED166A 		vldr.32	s12, .L15+28
 110 0078 77EE867A 		vadd.f32	s15, s15, s12
  29:./app/filter/filter.c **** }
 111              		.loc 1 29 44 view .LVU28
 112 007c 67EEA67A 		vmul.f32	s15, s15, s13
  29:./app/filter/filter.c **** }
 113              		.loc 1 29 39 view .LVU29
 114 0080 DFED146A 		vldr.32	s13, .L15+32
 115              	.LVL10:
  29:./app/filter/filter.c **** }
 116              		.loc 1 29 39 view .LVU30
 117 0084 77EEE67A 		vsub.f32	s15, s15, s13
  29:./app/filter/filter.c **** }
 118              		.loc 1 29 23 view .LVU31
ARM GAS  /tmp/ccRw3Duq.s 			page 4


 119 0088 67EE277A 		vmul.f32	s15, s14, s15
  29:./app/filter/filter.c **** }
 120              		.loc 1 29 14 view .LVU32
 121 008c 37EE800A 		vadd.f32	s0, s15, s0
 122              	.LVL11:
  29:./app/filter/filter.c **** }
 123              		.loc 1 29 14 view .LVU33
 124 0090 7047     		bx	lr
 125              	.LVL12:
 126              	.L14:
  27:./app/filter/filter.c ****     float x2 = x * x;
 127              		.loc 1 27 10 is_stmt 1 view .LVU34
  27:./app/filter/filter.c ****     float x2 = x * x;
 128              		.loc 1 27 13 is_stmt 0 view .LVU35
 129 0092 DFED117A 		vldr.32	s15, .L15+36
 130 0096 B4EEE70A 		vcmpe.f32	s0, s15
 131 009a F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 132 009e DBD5     		bpl	.L9
  27:./app/filter/filter.c ****     float x2 = x * x;
 133              		.loc 1 27 35 is_stmt 1 discriminator 1 view .LVU36
  27:./app/filter/filter.c ****     float x2 = x * x;
 134              		.loc 1 27 73 is_stmt 0 discriminator 1 view .LVU37
 135 00a0 DFED087A 		vldr.32	s15, .L15+16
 136 00a4 30EE270A 		vadd.f32	s0, s0, s15
 137              	.LVL13:
  27:./app/filter/filter.c ****     float x2 = x * x;
 138              		.loc 1 27 37 discriminator 1 view .LVU38
 139 00a8 DFED0B7A 		vldr.32	s15, .L15+36
 140 00ac 37EEC00A 		vsub.f32	s0, s15, s0
 141              	.LVL14:
  27:./app/filter/filter.c ****     float x2 = x * x;
 142              		.loc 1 27 37 discriminator 1 view .LVU39
 143 00b0 D2E7     		b	.L9
 144              	.L16:
 145 00b2 00BF     		.align	2
 146              	.L15:
 147 00b4 00000000 		.word	0
 148 00b8 DA0FC940 		.word	1086918618
 149 00bc DA0F4940 		.word	1078530010
 150 00c0 DA0F49C0 		.word	-1068953638
 151 00c4 DA0FC93F 		.word	1070141402
 152 00c8 9A7C2E36 		.word	909016218
 153 00cc FAAF4F39 		.word	961523706
 154 00d0 3587083C 		.word	1007191861
 155 00d4 A4AA2A3E 		.word	1042983588
 156 00d8 DA0FC9BF 		.word	-1077342246
 157              		.cfi_endproc
 158              	.LFE123:
 160              		.section	.text.cos_approx,"ax",%progbits
 161              		.align	1
 162              		.global	cos_approx
 163              		.syntax unified
 164              		.thumb
 165              		.thumb_func
 166              		.fpu fpv4-sp-d16
 168              	cos_approx:
 169              	.LVL15:
ARM GAS  /tmp/ccRw3Duq.s 			page 5


 170              	.LFB124:
  31:./app/filter/filter.c **** 
  32:./app/filter/filter.c **** float cos_approx(float x)
  33:./app/filter/filter.c **** {
 171              		.loc 1 33 1 is_stmt 1 view -0
 172              		.cfi_startproc
 173              		@ args = 0, pretend = 0, frame = 0
 174              		@ frame_needed = 0, uses_anonymous_args = 0
 175              		.loc 1 33 1 is_stmt 0 view .LVU41
 176 0000 08B5     		push	{r3, lr}
 177              	.LCFI0:
 178              		.cfi_def_cfa_offset 8
 179              		.cfi_offset 3, -8
 180              		.cfi_offset 14, -4
  34:./app/filter/filter.c ****     return sin_approx(x + (0.5f * M_PIf));
 181              		.loc 1 34 5 is_stmt 1 view .LVU42
 182              		.loc 1 34 12 is_stmt 0 view .LVU43
 183 0002 DFED037A 		vldr.32	s15, .L19
 184 0006 30EE270A 		vadd.f32	s0, s0, s15
 185              	.LVL16:
 186              		.loc 1 34 12 view .LVU44
 187 000a FFF7FEFF 		bl	sin_approx
 188              	.LVL17:
  35:./app/filter/filter.c **** }
 189              		.loc 1 35 1 view .LVU45
 190 000e 08BD     		pop	{r3, pc}
 191              	.L20:
 192              		.align	2
 193              	.L19:
 194 0010 DA0FC93F 		.word	1070141402
 195              		.cfi_endproc
 196              	.LFE124:
 198              		.section	.text.biquadFilterInit,"ax",%progbits
 199              		.align	1
 200              		.global	biquadFilterInit
 201              		.syntax unified
 202              		.thumb
 203              		.thumb_func
 204              		.fpu fpv4-sp-d16
 206              	biquadFilterInit:
 207              	.LVL18:
 208              	.LFB125:
  36:./app/filter/filter.c **** 
  37:./app/filter/filter.c **** /*双二阶滤波配置*/
  38:./app/filter/filter.c **** void biquadFilterInit(biquadFilter_t *filter, uint16_t samplingFreq, uint16_t filterFreq, float Q, 
  39:./app/filter/filter.c **** {
 209              		.loc 1 39 1 is_stmt 1 view -0
 210              		.cfi_startproc
 211              		@ args = 0, pretend = 0, frame = 0
 212              		@ frame_needed = 0, uses_anonymous_args = 0
 213              		.loc 1 39 1 is_stmt 0 view .LVU47
 214 0000 38B5     		push	{r3, r4, r5, lr}
 215              	.LCFI1:
 216              		.cfi_def_cfa_offset 16
 217              		.cfi_offset 3, -16
 218              		.cfi_offset 4, -12
 219              		.cfi_offset 5, -8
ARM GAS  /tmp/ccRw3Duq.s 			page 6


 220              		.cfi_offset 14, -4
 221 0002 2DED068B 		vpush.64	{d8, d9, d10}
 222              	.LCFI2:
 223              		.cfi_def_cfa_offset 40
 224              		.cfi_offset 80, -40
 225              		.cfi_offset 81, -36
 226              		.cfi_offset 82, -32
 227              		.cfi_offset 83, -28
 228              		.cfi_offset 84, -24
 229              		.cfi_offset 85, -20
 230 0006 0446     		mov	r4, r0
  40:./app/filter/filter.c ****     // Check for Nyquist frequency and if it's not possible to initialize filter as requested - set
  41:./app/filter/filter.c ****     if (filterFreq < (samplingFreq / 2)) {
 231              		.loc 1 41 5 is_stmt 1 view .LVU48
 232              		.loc 1 41 8 is_stmt 0 view .LVU49
 233 0008 B2EB510F 		cmp	r2, r1, lsr #1
 234 000c 0DD3     		bcc	.L28
  42:./app/filter/filter.c ****         // setup variables
  43:./app/filter/filter.c ****         const float sampleRate = samplingFreq;
  44:./app/filter/filter.c ****         const float omega = 2.0f * M_PIf * ((float)filterFreq) / sampleRate;
  45:./app/filter/filter.c ****         const float sn = sin_approx(omega);
  46:./app/filter/filter.c ****         const float cs = cos_approx(omega);
  47:./app/filter/filter.c ****         const float alpha = sn / (2 * Q);
  48:./app/filter/filter.c **** 
  49:./app/filter/filter.c ****         float b0, b1, b2;
  50:./app/filter/filter.c ****         switch (filterType) 
  51:./app/filter/filter.c ****         {
  52:./app/filter/filter.c ****             case FILTER_LPF:
  53:./app/filter/filter.c ****                 b0 = (1 - cs) / 2;
  54:./app/filter/filter.c ****                 b1 = 1 - cs;
  55:./app/filter/filter.c ****                 b2 = (1 - cs) / 2;
  56:./app/filter/filter.c ****                 break;
  57:./app/filter/filter.c ****             case FILTER_NOTCH:
  58:./app/filter/filter.c ****                 b0 =  1;
  59:./app/filter/filter.c ****                 b1 = -2 * cs;
  60:./app/filter/filter.c ****                 b2 =  1;
  61:./app/filter/filter.c ****                 break;
  62:./app/filter/filter.c ****         }
  63:./app/filter/filter.c ****         const float a0 =  1 + alpha;
  64:./app/filter/filter.c ****         const float a1 = -2 * cs;
  65:./app/filter/filter.c ****         const float a2 =  1 - alpha;
  66:./app/filter/filter.c **** 
  67:./app/filter/filter.c ****         // precompute the coefficients
  68:./app/filter/filter.c ****         filter->b0 = b0 / a0;
  69:./app/filter/filter.c ****         filter->b1 = b1 / a0;
  70:./app/filter/filter.c ****         filter->b2 = b2 / a0;
  71:./app/filter/filter.c ****         filter->a1 = a1 / a0;
  72:./app/filter/filter.c ****         filter->a2 = a2 / a0;
  73:./app/filter/filter.c ****     }
  74:./app/filter/filter.c ****     else 
  75:./app/filter/filter.c ****     {
  76:./app/filter/filter.c ****         // Not possible to filter frequencies above Nyquist frequency - passthrough
  77:./app/filter/filter.c ****         filter->b0 = 1.0f;
 235              		.loc 1 77 9 is_stmt 1 view .LVU50
 236              		.loc 1 77 20 is_stmt 0 view .LVU51
 237 000e 4FF07E53 		mov	r3, #1065353216
 238              	.LVL19:
ARM GAS  /tmp/ccRw3Duq.s 			page 7


 239              		.loc 1 77 20 view .LVU52
 240 0012 0360     		str	r3, [r0]	@ float
  78:./app/filter/filter.c ****         filter->b1 = 0.0f;
 241              		.loc 1 78 9 is_stmt 1 view .LVU53
 242              		.loc 1 78 20 is_stmt 0 view .LVU54
 243 0014 0023     		movs	r3, #0
 244 0016 4360     		str	r3, [r0, #4]	@ float
  79:./app/filter/filter.c ****         filter->b2 = 0.0f;
 245              		.loc 1 79 9 is_stmt 1 view .LVU55
 246              		.loc 1 79 20 is_stmt 0 view .LVU56
 247 0018 8360     		str	r3, [r0, #8]	@ float
  80:./app/filter/filter.c ****         filter->a1 = 0.0f;
 248              		.loc 1 80 9 is_stmt 1 view .LVU57
 249              		.loc 1 80 20 is_stmt 0 view .LVU58
 250 001a C360     		str	r3, [r0, #12]	@ float
  81:./app/filter/filter.c ****         filter->a2 = 0.0f;
 251              		.loc 1 81 9 is_stmt 1 view .LVU59
 252              		.loc 1 81 20 is_stmt 0 view .LVU60
 253 001c 0361     		str	r3, [r0, #16]	@ float
 254              	.LVL20:
 255              	.L26:
  82:./app/filter/filter.c ****     }
  83:./app/filter/filter.c **** 
  84:./app/filter/filter.c ****     // zero initial samples
  85:./app/filter/filter.c ****     filter->d1 = filter->d2 = 0;
 256              		.loc 1 85 5 is_stmt 1 view .LVU61
 257              		.loc 1 85 29 is_stmt 0 view .LVU62
 258 001e 0023     		movs	r3, #0
 259 0020 A361     		str	r3, [r4, #24]	@ float
 260              		.loc 1 85 16 view .LVU63
 261 0022 6361     		str	r3, [r4, #20]	@ float
  86:./app/filter/filter.c **** }
 262              		.loc 1 86 1 view .LVU64
 263 0024 BDEC068B 		vldm	sp!, {d8-d10}
 264              	.LCFI3:
 265              		.cfi_remember_state
 266              		.cfi_restore 84
 267              		.cfi_restore 85
 268              		.cfi_restore 82
 269              		.cfi_restore 83
 270              		.cfi_restore 80
 271              		.cfi_restore 81
 272              		.cfi_def_cfa_offset 16
 273 0028 38BD     		pop	{r3, r4, r5, pc}
 274              	.LVL21:
 275              	.L28:
 276              	.LCFI4:
 277              		.cfi_restore_state
 278              		.loc 1 86 1 view .LVU65
 279 002a B0EE408A 		vmov.f32	s16, s0
 280 002e 1D46     		mov	r5, r3
 281              	.LBB2:
  43:./app/filter/filter.c ****         const float omega = 2.0f * M_PIf * ((float)filterFreq) / sampleRate;
 282              		.loc 1 43 9 is_stmt 1 view .LVU66
  43:./app/filter/filter.c ****         const float omega = 2.0f * M_PIf * ((float)filterFreq) / sampleRate;
 283              		.loc 1 43 21 is_stmt 0 view .LVU67
 284 0030 07EE901A 		vmov	s15, r1	@ int
ARM GAS  /tmp/ccRw3Duq.s 			page 8


 285 0034 B8EE677A 		vcvt.f32.u32	s14, s15
 286              	.LVL22:
  44:./app/filter/filter.c ****         const float sn = sin_approx(omega);
 287              		.loc 1 44 9 is_stmt 1 view .LVU68
  44:./app/filter/filter.c ****         const float sn = sin_approx(omega);
 288              		.loc 1 44 45 is_stmt 0 view .LVU69
 289 0038 07EE902A 		vmov	s15, r2	@ int
 290 003c F8EE677A 		vcvt.f32.u32	s15, s15
  44:./app/filter/filter.c ****         const float sn = sin_approx(omega);
 291              		.loc 1 44 42 view .LVU70
 292 0040 DFED246A 		vldr.32	s13, .L29
 293 0044 67EEA67A 		vmul.f32	s15, s15, s13
  44:./app/filter/filter.c ****         const float sn = sin_approx(omega);
 294              		.loc 1 44 21 view .LVU71
 295 0048 C7EE87AA 		vdiv.f32	s21, s15, s14
 296              	.LVL23:
  45:./app/filter/filter.c ****         const float cs = cos_approx(omega);
 297              		.loc 1 45 9 is_stmt 1 view .LVU72
  45:./app/filter/filter.c ****         const float cs = cos_approx(omega);
 298              		.loc 1 45 26 is_stmt 0 view .LVU73
 299 004c B0EE6A0A 		vmov.f32	s0, s21
 300              	.LVL24:
  45:./app/filter/filter.c ****         const float cs = cos_approx(omega);
 301              		.loc 1 45 26 view .LVU74
 302 0050 FFF7FEFF 		bl	sin_approx
 303              	.LVL25:
  45:./app/filter/filter.c ****         const float cs = cos_approx(omega);
 304              		.loc 1 45 26 view .LVU75
 305 0054 F0EE408A 		vmov.f32	s17, s0
 306              	.LVL26:
  46:./app/filter/filter.c ****         const float alpha = sn / (2 * Q);
 307              		.loc 1 46 9 is_stmt 1 view .LVU76
  46:./app/filter/filter.c ****         const float alpha = sn / (2 * Q);
 308              		.loc 1 46 26 is_stmt 0 view .LVU77
 309 0058 B0EE6A0A 		vmov.f32	s0, s21
 310              	.LVL27:
  46:./app/filter/filter.c ****         const float alpha = sn / (2 * Q);
 311              		.loc 1 46 26 view .LVU78
 312 005c FFF7FEFF 		bl	cos_approx
 313              	.LVL28:
  47:./app/filter/filter.c **** 
 314              		.loc 1 47 9 is_stmt 1 view .LVU79
  47:./app/filter/filter.c **** 
 315              		.loc 1 47 37 is_stmt 0 view .LVU80
 316 0060 38EE088A 		vadd.f32	s16, s16, s16
 317              	.LVL29:
  47:./app/filter/filter.c **** 
 318              		.loc 1 47 21 view .LVU81
 319 0064 C8EE886A 		vdiv.f32	s13, s17, s16
 320              	.LVL30:
  49:./app/filter/filter.c ****         switch (filterType) 
 321              		.loc 1 49 9 is_stmt 1 view .LVU82
  50:./app/filter/filter.c ****         {
 322              		.loc 1 50 9 view .LVU83
 323 0068 05B3     		cbz	r5, .L23
 324 006a 012D     		cmp	r5, #1
 325 006c 29D0     		beq	.L24
ARM GAS  /tmp/ccRw3Duq.s 			page 9


 326              	.L25:
 327              	.LVL31:
  63:./app/filter/filter.c ****         const float a1 = -2 * cs;
 328              		.loc 1 63 9 view .LVU84
  63:./app/filter/filter.c ****         const float a1 = -2 * cs;
 329              		.loc 1 63 21 is_stmt 0 view .LVU85
 330 006e B7EE007A 		vmov.f32	s14, #1.0e+0
 331 0072 76EE877A 		vadd.f32	s15, s13, s14
 332              	.LVL32:
  64:./app/filter/filter.c ****         const float a2 =  1 - alpha;
 333              		.loc 1 64 9 is_stmt 1 view .LVU86
  64:./app/filter/filter.c ****         const float a2 =  1 - alpha;
 334              		.loc 1 64 21 is_stmt 0 view .LVU87
 335 0076 B8EE006A 		vmov.f32	s12, #-2.0e+0
 336 007a 20EE060A 		vmul.f32	s0, s0, s12
 337              	.LVL33:
  65:./app/filter/filter.c **** 
 338              		.loc 1 65 9 is_stmt 1 view .LVU88
  65:./app/filter/filter.c **** 
 339              		.loc 1 65 21 is_stmt 0 view .LVU89
 340 007e 37EE667A 		vsub.f32	s14, s14, s13
 341              	.LVL34:
  68:./app/filter/filter.c ****         filter->b1 = b1 / a0;
 342              		.loc 1 68 9 is_stmt 1 view .LVU90
  68:./app/filter/filter.c ****         filter->b1 = b1 / a0;
 343              		.loc 1 68 25 is_stmt 0 view .LVU91
 344 0082 C9EEA76A 		vdiv.f32	s13, s19, s15
 345              	.LVL35:
  68:./app/filter/filter.c ****         filter->b1 = b1 / a0;
 346              		.loc 1 68 20 view .LVU92
 347 0086 C4ED006A 		vstr.32	s13, [r4]
  69:./app/filter/filter.c ****         filter->b2 = b2 / a0;
 348              		.loc 1 69 9 is_stmt 1 view .LVU93
  69:./app/filter/filter.c ****         filter->b2 = b2 / a0;
 349              		.loc 1 69 25 is_stmt 0 view .LVU94
 350 008a C9EE276A 		vdiv.f32	s13, s18, s15
  69:./app/filter/filter.c ****         filter->b2 = b2 / a0;
 351              		.loc 1 69 20 view .LVU95
 352 008e C4ED016A 		vstr.32	s13, [r4, #4]
  70:./app/filter/filter.c ****         filter->a1 = a1 / a0;
 353              		.loc 1 70 9 is_stmt 1 view .LVU96
  70:./app/filter/filter.c ****         filter->a1 = a1 / a0;
 354              		.loc 1 70 25 is_stmt 0 view .LVU97
 355 0092 CAEE276A 		vdiv.f32	s13, s20, s15
  70:./app/filter/filter.c ****         filter->a1 = a1 / a0;
 356              		.loc 1 70 20 view .LVU98
 357 0096 C4ED026A 		vstr.32	s13, [r4, #8]
  71:./app/filter/filter.c ****         filter->a2 = a2 / a0;
 358              		.loc 1 71 9 is_stmt 1 view .LVU99
  71:./app/filter/filter.c ****         filter->a2 = a2 / a0;
 359              		.loc 1 71 25 is_stmt 0 view .LVU100
 360 009a C0EE276A 		vdiv.f32	s13, s0, s15
  71:./app/filter/filter.c ****         filter->a2 = a2 / a0;
 361              		.loc 1 71 20 view .LVU101
 362 009e C4ED036A 		vstr.32	s13, [r4, #12]
  72:./app/filter/filter.c ****     }
 363              		.loc 1 72 9 is_stmt 1 view .LVU102
ARM GAS  /tmp/ccRw3Duq.s 			page 10


  72:./app/filter/filter.c ****     }
 364              		.loc 1 72 25 is_stmt 0 view .LVU103
 365 00a2 C7EE276A 		vdiv.f32	s13, s14, s15
  72:./app/filter/filter.c ****     }
 366              		.loc 1 72 20 view .LVU104
 367 00a6 C4ED046A 		vstr.32	s13, [r4, #16]
 368              	.LBE2:
 369 00aa B8E7     		b	.L26
 370              	.LVL36:
 371              	.L23:
 372              	.LBB3:
  53:./app/filter/filter.c ****                 b1 = 1 - cs;
 373              		.loc 1 53 17 is_stmt 1 view .LVU105
  53:./app/filter/filter.c ****                 b1 = 1 - cs;
 374              		.loc 1 53 25 is_stmt 0 view .LVU106
 375 00ac B7EE009A 		vmov.f32	s18, #1.0e+0
 376 00b0 39EE409A 		vsub.f32	s18, s18, s0
  53:./app/filter/filter.c ****                 b1 = 1 - cs;
 377              		.loc 1 53 20 view .LVU107
 378 00b4 F6EE009A 		vmov.f32	s19, #5.0e-1
 379 00b8 69EE299A 		vmul.f32	s19, s18, s19
 380              	.LVL37:
  54:./app/filter/filter.c ****                 b2 = (1 - cs) / 2;
 381              		.loc 1 54 17 is_stmt 1 view .LVU108
  55:./app/filter/filter.c ****                 break;
 382              		.loc 1 55 17 view .LVU109
  56:./app/filter/filter.c ****             case FILTER_NOTCH:
 383              		.loc 1 56 17 view .LVU110
  55:./app/filter/filter.c ****                 break;
 384              		.loc 1 55 20 is_stmt 0 view .LVU111
 385 00bc B0EE69AA 		vmov.f32	s20, s19
  56:./app/filter/filter.c ****             case FILTER_NOTCH:
 386              		.loc 1 56 17 view .LVU112
 387 00c0 D5E7     		b	.L25
 388              	.LVL38:
 389              	.L24:
  58:./app/filter/filter.c ****                 b1 = -2 * cs;
 390              		.loc 1 58 17 is_stmt 1 view .LVU113
  59:./app/filter/filter.c ****                 b2 =  1;
 391              		.loc 1 59 17 view .LVU114
  59:./app/filter/filter.c ****                 b2 =  1;
 392              		.loc 1 59 20 is_stmt 0 view .LVU115
 393 00c2 B8EE009A 		vmov.f32	s18, #-2.0e+0
 394 00c6 20EE099A 		vmul.f32	s18, s0, s18
 395              	.LVL39:
  60:./app/filter/filter.c ****                 break;
 396              		.loc 1 60 17 is_stmt 1 view .LVU116
  61:./app/filter/filter.c ****         }
 397              		.loc 1 61 17 view .LVU117
  60:./app/filter/filter.c ****                 break;
 398              		.loc 1 60 20 is_stmt 0 view .LVU118
 399 00ca B7EE00AA 		vmov.f32	s20, #1.0e+0
  58:./app/filter/filter.c ****                 b1 = -2 * cs;
 400              		.loc 1 58 20 view .LVU119
 401 00ce F0EE4A9A 		vmov.f32	s19, s20
  61:./app/filter/filter.c ****         }
 402              		.loc 1 61 17 view .LVU120
ARM GAS  /tmp/ccRw3Duq.s 			page 11


 403 00d2 CCE7     		b	.L25
 404              	.L30:
 405              		.align	2
 406              	.L29:
 407 00d4 DA0FC940 		.word	1086918618
 408              	.LBE3:
 409              		.cfi_endproc
 410              	.LFE125:
 412              		.section	.text.biquad_filter_init_lpf,"ax",%progbits
 413              		.align	1
 414              		.global	biquad_filter_init_lpf
 415              		.syntax unified
 416              		.thumb
 417              		.thumb_func
 418              		.fpu fpv4-sp-d16
 420              	biquad_filter_init_lpf:
 421              	.LVL40:
 422              	.LFB126:
  87:./app/filter/filter.c **** 
  88:./app/filter/filter.c **** 
  89:./app/filter/filter.c **** /*双二阶低通滤波初始化*/
  90:./app/filter/filter.c **** void biquad_filter_init_lpf(biquadFilter_t *filter, uint16_t samplingFreq, uint16_t filterFreq)
  91:./app/filter/filter.c **** {
 423              		.loc 1 91 1 is_stmt 1 view -0
 424              		.cfi_startproc
 425              		@ args = 0, pretend = 0, frame = 0
 426              		@ frame_needed = 0, uses_anonymous_args = 0
 427              		.loc 1 91 1 is_stmt 0 view .LVU122
 428 0000 08B5     		push	{r3, lr}
 429              	.LCFI5:
 430              		.cfi_def_cfa_offset 8
 431              		.cfi_offset 3, -8
 432              		.cfi_offset 14, -4
  92:./app/filter/filter.c ****     biquadFilterInit(filter, samplingFreq, filterFreq, BIQUAD_Q, FILTER_LPF);
 433              		.loc 1 92 5 is_stmt 1 view .LVU123
 434 0002 0023     		movs	r3, #0
 435 0004 9FED020A 		vldr.32	s0, .L33
 436 0008 FFF7FEFF 		bl	biquadFilterInit
 437              	.LVL41:
  93:./app/filter/filter.c **** }
 438              		.loc 1 93 1 is_stmt 0 view .LVU124
 439 000c 08BD     		pop	{r3, pc}
 440              	.L34:
 441 000e 00BF     		.align	2
 442              	.L33:
 443 0010 F304353F 		.word	1060439283
 444              		.cfi_endproc
 445              	.LFE126:
 447              		.section	.text.filterGetNotchQ,"ax",%progbits
 448              		.align	1
 449              		.global	filterGetNotchQ
 450              		.syntax unified
 451              		.thumb
 452              		.thumb_func
 453              		.fpu fpv4-sp-d16
 455              	filterGetNotchQ:
 456              	.LVL42:
ARM GAS  /tmp/ccRw3Duq.s 			page 12


 457              	.LFB127:
  94:./app/filter/filter.c **** 
  95:./app/filter/filter.c **** float filterGetNotchQ(uint16_t centerFreq, uint16_t cutoff)
  96:./app/filter/filter.c **** {
 458              		.loc 1 96 1 is_stmt 1 view -0
 459              		.cfi_startproc
 460              		@ args = 0, pretend = 0, frame = 0
 461              		@ frame_needed = 0, uses_anonymous_args = 0
 462              		.loc 1 96 1 is_stmt 0 view .LVU126
 463 0000 08B5     		push	{r3, lr}
 464              	.LCFI6:
 465              		.cfi_def_cfa_offset 8
 466              		.cfi_offset 3, -8
 467              		.cfi_offset 14, -4
 468 0002 2DED028B 		vpush.64	{d8}
 469              	.LCFI7:
 470              		.cfi_def_cfa_offset 16
 471              		.cfi_offset 80, -16
 472              		.cfi_offset 81, -12
 473 0006 00EE100A 		vmov	s0, r0	@ int
 474 000a 07EE901A 		vmov	s15, r1	@ int
  97:./app/filter/filter.c ****     const float octaves = log2f((float)centerFreq  / (float)cutoff) * 2;
 475              		.loc 1 97 5 is_stmt 1 view .LVU127
 476              		.loc 1 97 33 is_stmt 0 view .LVU128
 477 000e B8EE400A 		vcvt.f32.u32	s0, s0
 478              		.loc 1 97 54 view .LVU129
 479 0012 F8EE677A 		vcvt.f32.u32	s15, s15
 480              		.loc 1 97 27 view .LVU130
 481 0016 80EE270A 		vdiv.f32	s0, s0, s15
 482 001a FFF7FEFF 		bl	log2f
 483              	.LVL43:
 484              		.loc 1 97 17 view .LVU131
 485 001e 30EE008A 		vadd.f32	s16, s0, s0
 486              	.LVL44:
  98:./app/filter/filter.c ****     return sqrtf(powf(2, octaves)) / (powf(2, octaves) - 1);
 487              		.loc 1 98 5 is_stmt 1 view .LVU132
 488              		.loc 1 98 12 is_stmt 0 view .LVU133
 489 0022 F0EE480A 		vmov.f32	s1, s16
 490 0026 B0EE000A 		vmov.f32	s0, #2.0e+0
 491 002a FFF7FEFF 		bl	powf
 492              	.LVL45:
 493 002e FFF7FEFF 		bl	sqrtf
 494              	.LVL46:
 495 0032 F0EE408A 		vmov.f32	s17, s0
 496              		.loc 1 98 39 view .LVU134
 497 0036 F0EE480A 		vmov.f32	s1, s16
 498 003a B0EE000A 		vmov.f32	s0, #2.0e+0
 499 003e FFF7FEFF 		bl	powf
 500              	.LVL47:
 501              		.loc 1 98 56 view .LVU135
 502 0042 F7EE007A 		vmov.f32	s15, #1.0e+0
 503 0046 30EE670A 		vsub.f32	s0, s0, s15
  99:./app/filter/filter.c **** }
 504              		.loc 1 99 1 view .LVU136
 505 004a 88EE800A 		vdiv.f32	s0, s17, s0
 506 004e BDEC028B 		vldm	sp!, {d8}
 507              	.LCFI8:
ARM GAS  /tmp/ccRw3Duq.s 			page 13


 508              		.cfi_restore 80
 509              		.cfi_restore 81
 510              		.cfi_def_cfa_offset 8
 511              	.LVL48:
 512              		.loc 1 99 1 view .LVU137
 513 0052 08BD     		pop	{r3, pc}
 514              		.cfi_endproc
 515              	.LFE127:
 517              		.section	.text.biquad_filter_init_notch,"ax",%progbits
 518              		.align	1
 519              		.global	biquad_filter_init_notch
 520              		.syntax unified
 521              		.thumb
 522              		.thumb_func
 523              		.fpu fpv4-sp-d16
 525              	biquad_filter_init_notch:
 526              	.LVL49:
 527              	.LFB128:
 100:./app/filter/filter.c **** 
 101:./app/filter/filter.c **** 
 102:./app/filter/filter.c **** void biquad_filter_init_notch(biquadFilter_t *filter, uint16_t samplingFreq, uint16_t filterFreq, u
 103:./app/filter/filter.c **** {
 528              		.loc 1 103 1 is_stmt 1 view -0
 529              		.cfi_startproc
 530              		@ args = 0, pretend = 0, frame = 0
 531              		@ frame_needed = 0, uses_anonymous_args = 0
 532              		.loc 1 103 1 is_stmt 0 view .LVU139
 533 0000 70B5     		push	{r4, r5, r6, lr}
 534              	.LCFI9:
 535              		.cfi_def_cfa_offset 16
 536              		.cfi_offset 4, -16
 537              		.cfi_offset 5, -12
 538              		.cfi_offset 6, -8
 539              		.cfi_offset 14, -4
 540 0002 0546     		mov	r5, r0
 541 0004 0E46     		mov	r6, r1
 542 0006 1446     		mov	r4, r2
 104:./app/filter/filter.c ****     float Q = filterGetNotchQ(filterFreq, cutoffHz);
 543              		.loc 1 104 5 is_stmt 1 view .LVU140
 544              		.loc 1 104 15 is_stmt 0 view .LVU141
 545 0008 1946     		mov	r1, r3
 546              	.LVL50:
 547              		.loc 1 104 15 view .LVU142
 548 000a 1046     		mov	r0, r2
 549              	.LVL51:
 550              		.loc 1 104 15 view .LVU143
 551 000c FFF7FEFF 		bl	filterGetNotchQ
 552              	.LVL52:
 105:./app/filter/filter.c ****     biquadFilterInit(filter, samplingFreq, filterFreq, Q, FILTER_NOTCH);
 553              		.loc 1 105 5 is_stmt 1 view .LVU144
 554 0010 0123     		movs	r3, #1
 555 0012 2246     		mov	r2, r4
 556 0014 3146     		mov	r1, r6
 557 0016 2846     		mov	r0, r5
 558 0018 FFF7FEFF 		bl	biquadFilterInit
 559              	.LVL53:
 106:./app/filter/filter.c **** }
ARM GAS  /tmp/ccRw3Duq.s 			page 14


 560              		.loc 1 106 1 is_stmt 0 view .LVU145
 561 001c 70BD     		pop	{r4, r5, r6, pc}
 562              		.loc 1 106 1 view .LVU146
 563              		.cfi_endproc
 564              	.LFE128:
 566              		.section	.text.biquad_filter,"ax",%progbits
 567              		.align	1
 568              		.global	biquad_filter
 569              		.syntax unified
 570              		.thumb
 571              		.thumb_func
 572              		.fpu fpv4-sp-d16
 574              	biquad_filter:
 575              	.LVL54:
 576              	.LFB129:
 107:./app/filter/filter.c **** 
 108:./app/filter/filter.c **** 
 109:./app/filter/filter.c **** /*双二阶低通滤波*/
 110:./app/filter/filter.c **** float biquad_filter(biquadFilter_t *filter, float input)
 111:./app/filter/filter.c **** {
 577              		.loc 1 111 1 is_stmt 1 view -0
 578              		.cfi_startproc
 579              		@ args = 0, pretend = 0, frame = 0
 580              		@ frame_needed = 0, uses_anonymous_args = 0
 581              		@ link register save eliminated.
 582              		.loc 1 111 1 is_stmt 0 view .LVU148
 583 0000 B0EE407A 		vmov.f32	s14, s0
 112:./app/filter/filter.c ****     const float result = filter->b0 * input + filter->d1;
 584              		.loc 1 112 5 is_stmt 1 view .LVU149
 585              		.loc 1 112 32 is_stmt 0 view .LVU150
 586 0004 D0ED007A 		vldr.32	s15, [r0]
 587              		.loc 1 112 37 view .LVU151
 588 0008 67EE807A 		vmul.f32	s15, s15, s0
 589              		.loc 1 112 53 view .LVU152
 590 000c 90ED050A 		vldr.32	s0, [r0, #20]
 591              	.LVL55:
 592              		.loc 1 112 17 view .LVU153
 593 0010 37EE800A 		vadd.f32	s0, s15, s0
 594              	.LVL56:
 113:./app/filter/filter.c ****     filter->d1 = filter->b1 * input - filter->a1 * result + filter->d2;
 595              		.loc 1 113 5 is_stmt 1 view .LVU154
 596              		.loc 1 113 24 is_stmt 0 view .LVU155
 597 0014 D0ED017A 		vldr.32	s15, [r0, #4]
 598              		.loc 1 113 29 view .LVU156
 599 0018 67EE877A 		vmul.f32	s15, s15, s14
 600              		.loc 1 113 45 view .LVU157
 601 001c D0ED036A 		vldr.32	s13, [r0, #12]
 602              		.loc 1 113 50 view .LVU158
 603 0020 66EE806A 		vmul.f32	s13, s13, s0
 604              		.loc 1 113 37 view .LVU159
 605 0024 77EEE67A 		vsub.f32	s15, s15, s13
 606              		.loc 1 113 67 view .LVU160
 607 0028 D0ED066A 		vldr.32	s13, [r0, #24]
 608              		.loc 1 113 59 view .LVU161
 609 002c 77EEA67A 		vadd.f32	s15, s15, s13
 610              		.loc 1 113 16 view .LVU162
 611 0030 C0ED057A 		vstr.32	s15, [r0, #20]
ARM GAS  /tmp/ccRw3Duq.s 			page 15


 114:./app/filter/filter.c ****     filter->d2 = filter->b2 * input - filter->a2 * result;
 612              		.loc 1 114 5 is_stmt 1 view .LVU163
 613              		.loc 1 114 24 is_stmt 0 view .LVU164
 614 0034 D0ED027A 		vldr.32	s15, [r0, #8]
 615              		.loc 1 114 29 view .LVU165
 616 0038 67EE877A 		vmul.f32	s15, s15, s14
 617              		.loc 1 114 45 view .LVU166
 618 003c 90ED047A 		vldr.32	s14, [r0, #16]
 619              	.LVL57:
 620              		.loc 1 114 50 view .LVU167
 621 0040 27EE007A 		vmul.f32	s14, s14, s0
 622              		.loc 1 114 37 view .LVU168
 623 0044 77EEC77A 		vsub.f32	s15, s15, s14
 624              		.loc 1 114 16 view .LVU169
 625 0048 C0ED067A 		vstr.32	s15, [r0, #24]
 115:./app/filter/filter.c ****     return result;
 626              		.loc 1 115 5 is_stmt 1 view .LVU170
 116:./app/filter/filter.c **** }
 627              		.loc 1 116 1 is_stmt 0 view .LVU171
 628 004c 7047     		bx	lr
 629              		.cfi_endproc
 630              	.LFE129:
 632              		.section	.text.sliding_filter,"ax",%progbits
 633              		.align	1
 634              		.global	sliding_filter
 635              		.syntax unified
 636              		.thumb
 637              		.thumb_func
 638              		.fpu fpv4-sp-d16
 640              	sliding_filter:
 641              	.LVL58:
 642              	.LFB130:
 117:./app/filter/filter.c **** 
 118:./app/filter/filter.c **** 
 119:./app/filter/filter.c **** /*滑动滤波*/
 120:./app/filter/filter.c **** float sliding_filter(float input,float * buff,uint32_t buff_size)
 121:./app/filter/filter.c **** {
 643              		.loc 1 121 1 is_stmt 1 view -0
 644              		.cfi_startproc
 645              		@ args = 0, pretend = 0, frame = 0
 646              		@ frame_needed = 0, uses_anonymous_args = 0
 647              		.loc 1 121 1 is_stmt 0 view .LVU173
 648 0000 00B5     		push	{lr}
 649              	.LCFI10:
 650              		.cfi_def_cfa_offset 4
 651              		.cfi_offset 14, -4
 122:./app/filter/filter.c ****     uint32_t i;
 652              		.loc 1 122 5 is_stmt 1 view .LVU174
 123:./app/filter/filter.c ****     float out;
 653              		.loc 1 123 5 view .LVU175
 124:./app/filter/filter.c ****     float sum = 0;
 654              		.loc 1 124 5 view .LVU176
 655              	.LVL59:
 125:./app/filter/filter.c **** 
 126:./app/filter/filter.c ****     //更新缓存
 127:./app/filter/filter.c ****     for(i = buff_size - 1;i > 0;i--)
 656              		.loc 1 127 5 view .LVU177
ARM GAS  /tmp/ccRw3Duq.s 			page 16


 657              		.loc 1 127 11 is_stmt 0 view .LVU178
 658 0002 4A1E     		subs	r2, r1, #1
 659              	.LVL60:
 124:./app/filter/filter.c ****     float sum = 0;
 660              		.loc 1 124 11 view .LVU179
 661 0004 DFED107A 		vldr.32	s15, .L44
 662              		.loc 1 127 5 view .LVU180
 663 0008 0FE0     		b	.L41
 664              	.LVL61:
 665              	.L42:
 128:./app/filter/filter.c ****     {
 129:./app/filter/filter.c ****         buff[i] = buff[i-1];
 666              		.loc 1 129 9 is_stmt 1 discriminator 3 view .LVU181
 667              		.loc 1 129 23 is_stmt 0 discriminator 3 view .LVU182
 668 000a 02F18043 		add	r3, r2, #1073741824
 669 000e 013B     		subs	r3, r3, #1
 670 0010 00EB8303 		add	r3, r0, r3, lsl #2
 671              		.loc 1 129 13 discriminator 3 view .LVU183
 672 0014 00EB820C 		add	ip, r0, r2, lsl #2
 673              		.loc 1 129 23 discriminator 3 view .LVU184
 674 0018 D3F800E0 		ldr	lr, [r3]	@ float
 675              		.loc 1 129 17 discriminator 3 view .LVU185
 676 001c CCF800E0 		str	lr, [ip]	@ float
 130:./app/filter/filter.c ****         sum += buff[i-1];
 677              		.loc 1 130 9 is_stmt 1 discriminator 3 view .LVU186
 678              		.loc 1 130 20 is_stmt 0 discriminator 3 view .LVU187
 679 0020 93ED007A 		vldr.32	s14, [r3]
 680              		.loc 1 130 13 discriminator 3 view .LVU188
 681 0024 77EE877A 		vadd.f32	s15, s15, s14
 682              	.LVL62:
 127:./app/filter/filter.c ****     {
 683              		.loc 1 127 33 is_stmt 1 discriminator 3 view .LVU189
 127:./app/filter/filter.c ****     {
 684              		.loc 1 127 34 is_stmt 0 discriminator 3 view .LVU190
 685 0028 013A     		subs	r2, r2, #1
 686              	.LVL63:
 687              	.L41:
 127:./app/filter/filter.c ****     {
 688              		.loc 1 127 27 is_stmt 1 discriminator 1 view .LVU191
 127:./app/filter/filter.c ****     {
 689              		.loc 1 127 5 is_stmt 0 discriminator 1 view .LVU192
 690 002a 002A     		cmp	r2, #0
 691 002c EDD1     		bne	.L42
 131:./app/filter/filter.c ****     }
 132:./app/filter/filter.c ****     buff[0] = input;
 692              		.loc 1 132 5 is_stmt 1 view .LVU193
 693              		.loc 1 132 13 is_stmt 0 view .LVU194
 694 002e 80ED000A 		vstr.32	s0, [r0]
 133:./app/filter/filter.c ****     sum += buff[0];
 695              		.loc 1 133 5 is_stmt 1 view .LVU195
 696              		.loc 1 133 9 is_stmt 0 view .LVU196
 697 0032 77EE807A 		vadd.f32	s15, s15, s0
 698              	.LVL64:
 134:./app/filter/filter.c **** 
 135:./app/filter/filter.c ****     out = sum / buff_size;
 699              		.loc 1 135 5 is_stmt 1 view .LVU197
 700              		.loc 1 135 15 is_stmt 0 view .LVU198
ARM GAS  /tmp/ccRw3Duq.s 			page 17


 701 0036 07EE101A 		vmov	s14, r1	@ int
 702 003a B8EE470A 		vcvt.f32.u32	s0, s14
 703              	.LVL65:
 136:./app/filter/filter.c **** 
 137:./app/filter/filter.c ****     return out;
 704              		.loc 1 137 5 is_stmt 1 view .LVU199
 138:./app/filter/filter.c **** }
 705              		.loc 1 138 1 is_stmt 0 view .LVU200
 706 003e 87EE800A 		vdiv.f32	s0, s15, s0
 707              	.LVL66:
 708              		.loc 1 138 1 view .LVU201
 709 0042 5DF804FB 		ldr	pc, [sp], #4
 710              	.L45:
 711 0046 00BF     		.align	2
 712              	.L44:
 713 0048 00000000 		.word	0
 714              		.cfi_endproc
 715              	.LFE130:
 717              		.section	.text.LowPassFilter,"ax",%progbits
 718              		.align	1
 719              		.global	LowPassFilter
 720              		.syntax unified
 721              		.thumb
 722              		.thumb_func
 723              		.fpu fpv4-sp-d16
 725              	LowPassFilter:
 726              	.LVL67:
 727              	.LFB131:
 139:./app/filter/filter.c **** 
 140:./app/filter/filter.c **** 
 141:./app/filter/filter.c **** float LowPassFilter(LowPassFilter_t * filter, float in)
 142:./app/filter/filter.c **** {
 728              		.loc 1 142 1 is_stmt 1 view -0
 729              		.cfi_startproc
 730              		@ args = 0, pretend = 0, frame = 0
 731              		@ frame_needed = 0, uses_anonymous_args = 0
 732              		@ link register save eliminated.
 143:./app/filter/filter.c **** 	float out;
 733              		.loc 1 143 2 view .LVU203
 144:./app/filter/filter.c **** 
 145:./app/filter/filter.c **** 	out = filter->K * in + (1 - filter->K) * filter->LastValue;
 734              		.loc 1 145 2 view .LVU204
 735              		.loc 1 145 14 is_stmt 0 view .LVU205
 736 0000 90ED007A 		vldr.32	s14, [r0]
 737              		.loc 1 145 18 view .LVU206
 738 0004 67EE006A 		vmul.f32	s13, s14, s0
 739              		.loc 1 145 28 view .LVU207
 740 0008 F7EE007A 		vmov.f32	s15, #1.0e+0
 741 000c 77EEC77A 		vsub.f32	s15, s15, s14
 742              		.loc 1 145 49 view .LVU208
 743 0010 90ED017A 		vldr.32	s14, [r0, #4]
 744              		.loc 1 145 41 view .LVU209
 745 0014 67EE877A 		vmul.f32	s15, s15, s14
 746              	.LVL68:
 146:./app/filter/filter.c **** 	filter->LastValue = in;
 747              		.loc 1 146 2 is_stmt 1 view .LVU210
 748              		.loc 1 146 20 is_stmt 0 view .LVU211
ARM GAS  /tmp/ccRw3Duq.s 			page 18


 749 0018 80ED010A 		vstr.32	s0, [r0, #4]
 147:./app/filter/filter.c **** 	
 148:./app/filter/filter.c **** 	return out;
 750              		.loc 1 148 2 is_stmt 1 view .LVU212
 149:./app/filter/filter.c **** }
 751              		.loc 1 149 1 is_stmt 0 view .LVU213
 752 001c 36EEA70A 		vadd.f32	s0, s13, s15
 753              	.LVL69:
 754              		.loc 1 149 1 view .LVU214
 755 0020 7047     		bx	lr
 756              		.cfi_endproc
 757              	.LFE131:
 759              		.section	.text.SlidingFilter,"ax",%progbits
 760              		.align	1
 761              		.global	SlidingFilter
 762              		.syntax unified
 763              		.thumb
 764              		.thumb_func
 765              		.fpu fpv4-sp-d16
 767              	SlidingFilter:
 768              	.LVL70:
 769              	.LFB132:
 150:./app/filter/filter.c **** 
 151:./app/filter/filter.c **** 
 152:./app/filter/filter.c **** //滑动滤波
 153:./app/filter/filter.c **** float SlidingFilter(SlidingFilter_t * filter, float in)
 154:./app/filter/filter.c **** {
 770              		.loc 1 154 1 is_stmt 1 view -0
 771              		.cfi_startproc
 772              		@ args = 0, pretend = 0, frame = 0
 773              		@ frame_needed = 0, uses_anonymous_args = 0
 774              		@ link register save eliminated.
 155:./app/filter/filter.c **** 
 156:./app/filter/filter.c **** 	uint32_t index;
 775              		.loc 1 156 2 view .LVU216
 157:./app/filter/filter.c **** 
 158:./app/filter/filter.c **** 	if((NULL == filter)
 776              		.loc 1 158 2 view .LVU217
 777              		.loc 1 158 4 is_stmt 0 view .LVU218
 778 0000 0346     		mov	r3, r0
 779 0002 10B3     		cbz	r0, .L50
 159:./app/filter/filter.c **** 		|| (NULL == filter->Buffer)
 780              		.loc 1 159 21 view .LVU219
 781 0004 8268     		ldr	r2, [r0, #8]
 782              		.loc 1 159 3 view .LVU220
 783 0006 1AB3     		cbz	r2, .L51
 160:./app/filter/filter.c **** 	)
 161:./app/filter/filter.c **** 	{
 162:./app/filter/filter.c **** 		return 0;
 163:./app/filter/filter.c **** 	}
 164:./app/filter/filter.c **** 
 165:./app/filter/filter.c **** 	
 166:./app/filter/filter.c **** 	index = filter->Index;
 784              		.loc 1 166 2 is_stmt 1 view .LVU221
 785              		.loc 1 166 8 is_stmt 0 view .LVU222
 786 0008 0168     		ldr	r1, [r0]
 787              	.LVL71:
ARM GAS  /tmp/ccRw3Duq.s 			page 19


 167:./app/filter/filter.c **** 
 168:./app/filter/filter.c **** 	//减去最旧的值
 169:./app/filter/filter.c **** 	filter->Sum -= filter->Buffer[index];
 788              		.loc 1 169 2 is_stmt 1 view .LVU223
 789              		.loc 1 169 31 is_stmt 0 view .LVU224
 790 000a 02EB8102 		add	r2, r2, r1, lsl #2
 791 000e 92ED007A 		vldr.32	s14, [r2]
 792              		.loc 1 169 14 view .LVU225
 793 0012 D0ED037A 		vldr.32	s15, [r0, #12]
 794 0016 77EEC77A 		vsub.f32	s15, s15, s14
 795 001a C0ED037A 		vstr.32	s15, [r0, #12]
 170:./app/filter/filter.c **** 
 171:./app/filter/filter.c **** 	//得到新值
 172:./app/filter/filter.c **** 	filter->Sum += in;
 796              		.loc 1 172 2 is_stmt 1 view .LVU226
 797              		.loc 1 172 14 is_stmt 0 view .LVU227
 798 001e 77EE807A 		vadd.f32	s15, s15, s0
 799 0022 C0ED037A 		vstr.32	s15, [r0, #12]
 173:./app/filter/filter.c **** 	filter->Buffer[index] = in;
 800              		.loc 1 173 2 is_stmt 1 view .LVU228
 801              		.loc 1 173 24 is_stmt 0 view .LVU229
 802 0026 82ED000A 		vstr.32	s0, [r2]
 174:./app/filter/filter.c **** 
 175:./app/filter/filter.c **** 	++index;
 803              		.loc 1 175 2 is_stmt 1 view .LVU230
 804 002a 4A1C     		adds	r2, r1, #1
 805              	.LVL72:
 176:./app/filter/filter.c **** 	if(index == filter->BufferSize)
 806              		.loc 1 176 2 view .LVU231
 807              		.loc 1 176 20 is_stmt 0 view .LVU232
 808 002c 4168     		ldr	r1, [r0, #4]
 809              		.loc 1 176 4 view .LVU233
 810 002e 9142     		cmp	r1, r2
 811 0030 09D0     		beq	.L53
 812              	.LVL73:
 813              	.L49:
 177:./app/filter/filter.c **** 	{
 178:./app/filter/filter.c **** 		index = 0;
 179:./app/filter/filter.c **** 	}
 180:./app/filter/filter.c **** 
 181:./app/filter/filter.c **** 	filter->Index = index;
 814              		.loc 1 181 2 is_stmt 1 view .LVU234
 815              		.loc 1 181 16 is_stmt 0 view .LVU235
 816 0032 1A60     		str	r2, [r3]
 182:./app/filter/filter.c **** 
 183:./app/filter/filter.c **** 	return (filter->Sum / filter->BufferSize);
 817              		.loc 1 183 2 is_stmt 1 view .LVU236
 818              		.loc 1 183 16 is_stmt 0 view .LVU237
 819 0034 93ED037A 		vldr.32	s14, [r3, #12]
 820              		.loc 1 183 22 view .LVU238
 821 0038 07EE901A 		vmov	s15, r1	@ int
 822 003c F8EE677A 		vcvt.f32.u32	s15, s15
 823 0040 87EE270A 		vdiv.f32	s0, s14, s15
 824              	.LVL74:
 825              		.loc 1 183 22 view .LVU239
 826 0044 7047     		bx	lr
 827              	.LVL75:
ARM GAS  /tmp/ccRw3Duq.s 			page 20


 828              	.L53:
 178:./app/filter/filter.c **** 	}
 829              		.loc 1 178 9 view .LVU240
 830 0046 0022     		movs	r2, #0
 831              	.LVL76:
 178:./app/filter/filter.c **** 	}
 832              		.loc 1 178 9 view .LVU241
 833 0048 F3E7     		b	.L49
 834              	.L50:
 162:./app/filter/filter.c **** 	}
 835              		.loc 1 162 10 view .LVU242
 836 004a 9FED030A 		vldr.32	s0, .L54
 837              	.LVL77:
 162:./app/filter/filter.c **** 	}
 838              		.loc 1 162 10 view .LVU243
 839 004e 7047     		bx	lr
 840              	.LVL78:
 841              	.L51:
 162:./app/filter/filter.c **** 	}
 842              		.loc 1 162 10 view .LVU244
 843 0050 9FED010A 		vldr.32	s0, .L54
 844              	.LVL79:
 184:./app/filter/filter.c **** }
 845              		.loc 1 184 1 view .LVU245
 846 0054 7047     		bx	lr
 847              	.L55:
 848 0056 00BF     		.align	2
 849              	.L54:
 850 0058 00000000 		.word	0
 851              		.cfi_endproc
 852              	.LFE132:
 854              		.text
 855              	.Letext0:
 856              		.file 2 "/usr/lib/gcc/arm-none-eabi/10.3.1/include/stdint.h"
 857              		.file 3 "./app/filter/filter.h"
 858              		.file 4 "/usr/include/newlib/math.h"
ARM GAS  /tmp/ccRw3Duq.s 			page 21


DEFINED SYMBOLS
                            *ABS*:0000000000000000 filter.c
     /tmp/ccRw3Duq.s:18     .text.sin_approx:0000000000000000 $t
     /tmp/ccRw3Duq.s:26     .text.sin_approx:0000000000000000 sin_approx
     /tmp/ccRw3Duq.s:147    .text.sin_approx:00000000000000b4 $d
     /tmp/ccRw3Duq.s:161    .text.cos_approx:0000000000000000 $t
     /tmp/ccRw3Duq.s:168    .text.cos_approx:0000000000000000 cos_approx
     /tmp/ccRw3Duq.s:194    .text.cos_approx:0000000000000010 $d
     /tmp/ccRw3Duq.s:199    .text.biquadFilterInit:0000000000000000 $t
     /tmp/ccRw3Duq.s:206    .text.biquadFilterInit:0000000000000000 biquadFilterInit
     /tmp/ccRw3Duq.s:407    .text.biquadFilterInit:00000000000000d4 $d
     /tmp/ccRw3Duq.s:413    .text.biquad_filter_init_lpf:0000000000000000 $t
     /tmp/ccRw3Duq.s:420    .text.biquad_filter_init_lpf:0000000000000000 biquad_filter_init_lpf
     /tmp/ccRw3Duq.s:443    .text.biquad_filter_init_lpf:0000000000000010 $d
     /tmp/ccRw3Duq.s:448    .text.filterGetNotchQ:0000000000000000 $t
     /tmp/ccRw3Duq.s:455    .text.filterGetNotchQ:0000000000000000 filterGetNotchQ
     /tmp/ccRw3Duq.s:518    .text.biquad_filter_init_notch:0000000000000000 $t
     /tmp/ccRw3Duq.s:525    .text.biquad_filter_init_notch:0000000000000000 biquad_filter_init_notch
     /tmp/ccRw3Duq.s:567    .text.biquad_filter:0000000000000000 $t
     /tmp/ccRw3Duq.s:574    .text.biquad_filter:0000000000000000 biquad_filter
     /tmp/ccRw3Duq.s:633    .text.sliding_filter:0000000000000000 $t
     /tmp/ccRw3Duq.s:640    .text.sliding_filter:0000000000000000 sliding_filter
     /tmp/ccRw3Duq.s:713    .text.sliding_filter:0000000000000048 $d
     /tmp/ccRw3Duq.s:718    .text.LowPassFilter:0000000000000000 $t
     /tmp/ccRw3Duq.s:725    .text.LowPassFilter:0000000000000000 LowPassFilter
     /tmp/ccRw3Duq.s:760    .text.SlidingFilter:0000000000000000 $t
     /tmp/ccRw3Duq.s:767    .text.SlidingFilter:0000000000000000 SlidingFilter
     /tmp/ccRw3Duq.s:850    .text.SlidingFilter:0000000000000058 $d

UNDEFINED SYMBOLS
log2f
powf
sqrtf
